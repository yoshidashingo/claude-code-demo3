# プロダクト要求定義書 (Product Requirements Document)

## プロダクト概要

### 名称
**Devtask** - 開発者向けタスク管理CLIツール

### プロダクトコンセプト
- **CLIで完結するタスク管理**: ターミナルから離れずにすべての操作を完結
- **優先順位の自動推定機能**: タスクの期限、作成日時、ステータス変更履歴などから優先順位を自動推定
- **シンプルで高速な操作感**: 最小限のキー入力で操作完了、即座のレスポンス

### プロダクトビジョン
開発者がターミナルから離れることなく、効率的にタスクを管理できるCLIツールを提供する。
コマンドラインでの操作に特化し、開発フローを中断させない軽量で高速なタスク管理を実現する。
優先順位の自動推定により、開発者は本質的な作業に集中できる。

### 目的
- ターミナルから離れずにタスク管理を完結
- 開発プロジェクトごとのタスク管理
- Git連携による開発フローとの統合
- シンプルで直感的なCLIインターフェース
- 高速な操作レスポンス
- AIによる優先順位自動推定で意思決定の負担軽減

## ターゲットユーザー

### 主要ユーザー
1. **ターミナル中心で開発する個人開発者**
   - 日常的にターミナルを使用
   - Vim/Emacs等のCLIエディタを愛用
   - GUIツールへの切り替えを避けたい
   - 効率重視の開発スタイル

2. **複数のプロジェクトを並行して進めるフリーランス**
   - クライアントごとに異なるプロジェクトを管理
   - プロジェクト切り替えが頻繁
   - 優先順位判断に時間を取られたくない
   - タスクの進捗可視化が必要

### ペルソナ

**田中太郎（28歳、フリーランスWebエンジニア）**
- 3つのクライアントプロジェクトを並行作業
- ターミナル（iTerm2 + Neovim）での作業が中心
- Gitを使用した個人開発
- タスク管理ツールとターミナルの行き来が面倒
- どのタスクを優先すべきか判断に迷う
- **ニーズ**: ターミナル内でタスク管理を完結し、優先順位を自動で提案してほしい

## 課題とニーズ

### 課題1: GUIツールへの切り替えコスト
- **現状**: ブラウザやGUIアプリでタスク管理
- **問題**: ターミナルとの切り替えで集中力が途切れる
- **ニーズ**: ターミナル内でタスク管理を完結

### 課題2: プロジェクトごとのタスク散在
- **現状**: 複数プロジェクトのタスクが混在
- **問題**: どのプロジェクトのタスクか分かりにくい
- **ニーズ**: プロジェクトごとにタスクを管理

### 課題3: Git作業とタスクの紐付け
- **現状**: タスクとブランチ・コミットの関連が不明確
- **問題**: 作業内容の追跡が困難
- **ニーズ**: Gitブランチとタスクを連携

### 課題4: 軽量・高速なツールの不足
- **現状**: 重いGUIツール、複雑な操作
- **問題**: 立ち上がりが遅い、操作が煩雑
- **ニーズ**: 即座に起動・操作できる軽量ツール

## 主要な機能一覧

### コア機能（P0: 必須）

#### 1. タスク管理
- タスクの作成（`devtask add`）
- タスクの編集（`devtask edit <id>`）
- タスクの削除（`devtask delete <id>`）
- タスク一覧表示（`devtask list`）
- タスク詳細表示（`devtask show <id>`）

#### 2. ステータス管理
- 3段階のステータス（todo / in-progress / done）
- ステータス変更（`devtask status <id> <status>`）
- ステータスごとの表示切り替え

#### 3. 優先度管理
- 3段階の優先度（high / medium / low）
- 優先度設定（`devtask priority <id> <priority>`）
- 優先度による並び替え
- **優先度自動推定機能**（差別化ポイント）
  - 期限までの残り時間で推定
  - 作成からの経過時間で推定
  - ステータス変更履歴で推定
  - タスクの依存関係で推定（将来的）
  - 推定結果の表示（`devtask list --auto-priority`）

#### 4. フィルタリング・検索
- ステータスでフィルタ（`devtask list --status=todo`）
- 優先度でフィルタ（`devtask list --priority=high`）
- キーワード検索（`devtask list --search="keyword"`）

#### 5. データ永続化
- プロジェクトディレクトリ内にタスクデータ保存
- JSONファイルでの管理（`.devtask/tasks.json`）
- `.gitignore`への自動追加（オプション）

### 重要機能（P1）

#### 6. 統計情報
- タスク統計表示（`devtask stats`）
- 完了率、ステータス別内訳
- 優先度別内訳

#### 7. プロジェクト管理
- プロジェクト初期化（`devtask init`）
- プロジェクト設定（プロジェクト名等）
- グローバルタスクとローカルタスクの分離

### 拡張機能（P2: あれば良い）

#### 8. Git連携
- ブランチ名とタスクの紐付け
- コミット時のタスクID自動付与
- ブランチ切り替え時のタスク切り替え

#### 9. 期限管理
- 期限設定（`devtask due <id> <date>`）
- 期限切れタスクの警告
- 期限でのソート

#### 10. タグ機能
- タスクへのタグ付け
- タグによるフィルタリング

### 将来的な機能（P3）

- チーム間でのタスク共有
- リモートリポジトリとの同期
- 複数プロジェクトの一元管理
- カスタムテンプレート
- プラグインシステム

## 成功の定義

### 定量的指標
- タスク作成から完了までの時間が50%短縮
- ツール起動時間が100ms以内
- コマンド実行から結果表示まで50ms以内
- 1000件のタスクでも快適に動作

### 定性的指標
- 開発者が日常的に使用する
- ターミナルから離れずにタスク管理できる
- Gitワークフローと自然に統合される
- シンプルで直感的なコマンド

## ビジネス要件

### スコープ
- **フェーズ1（MVP）**: 基本的なタスク管理機能
- **フェーズ2**: Git連携、期限管理
- **フェーズ3**: チーム機能、リモート同期

### 制約事項
- Node.js実行環境が必要
- ローカルファイルシステムを使用
- プロジェクトディレクトリ内で実行

### ライセンス
- MIT License（オープンソース）

## ユーザーストーリー

### US-001: タスクの作成
**As a** 開発者
**I want to** ターミナルから素早くタスクを作成する
**So that** 開発フローを中断せずにタスクを記録できる

**受け入れ条件:**
- `devtask add "タスクタイトル"` で作成できる
- オプションで説明、優先度、期限を指定できる
- 作成したタスクにIDが自動付与される
- 作成完了メッセージが表示される

### US-002: タスク一覧の表示
**As a** 開発者
**I want to** タスク一覧をターミナルで確認する
**So that** 今やるべきことを素早く把握できる

**受け入れ条件:**
- `devtask list` で一覧表示される
- ステータス別にグループ化される
- 優先度が色分けされる
- ID、タイトル、ステータス、優先度が表示される

### US-003: タスクのステータス変更
**As a** 開発者
**I want to** タスクのステータスを変更する
**So that** 作業の進捗を記録できる

**受け入れ条件:**
- `devtask status <id> <status>` で変更できる
- エイリアス（`devtask start <id>` など）が使える
- 変更完了メッセージが表示される

### US-004: タスクのフィルタリング
**As a** 開発者
**I want to** 特定条件でタスクを絞り込む
**So that** 必要なタスクだけを確認できる

**受け入れ条件:**
- ステータスでフィルタできる
- 優先度でフィルタできる
- キーワードで検索できる
- 複数条件の組み合わせができる

### US-005: プロジェクト初期化
**As a** 開発者
**I want to** プロジェクトでDevtaskを初期化する
**So that** プロジェクトごとにタスクを管理できる

**受け入れ条件:**
- `devtask init` で初期化される
- `.devtask/` ディレクトリが作成される
- `.gitignore` に自動追加される（Gitリポジトリの場合）
- プロジェクト名を設定できる

### US-006: 優先順位の自動推定
**As a** 開発者
**I want to** タスクの優先順位を自動で推定してほしい
**So that** どのタスクに取り組むべきか判断に迷わない

**受け入れ条件:**
- `devtask list --auto-priority` で推定優先度が表示される
- 期限、作成日時、ステータス変更履歴から総合的に判断される
- 推定ロジックが明確に説明される
- 手動設定した優先度は尊重される（オプション）

## 機能要件

### タスク管理

**FR-001: タスク作成**
- コマンド: `devtask add <title> [options]`
- オプション:
  - `-d, --description <text>`: 説明
  - `-p, --priority <high|medium|low>`: 優先度（デフォルト: medium）
  - `-s, --status <todo|in-progress|done>`: ステータス（デフォルト: todo）
  - `--due <date>`: 期限
- バリデーション:
  - タイトル: 必須、1～200文字
  - 説明: 任意、最大1000文字

**FR-002: タスク一覧表示**
- コマンド: `devtask list [options]`
- オプション:
  - `--status <status>`: ステータスフィルタ
  - `--priority <priority>`: 優先度フィルタ
  - `--search <keyword>`: キーワード検索
  - `--sort <field>`: ソート（priority, created, updated）
- 表示形式: ターミナルテーブル形式

**FR-003: タスク詳細表示**
- コマンド: `devtask show <id>`
- 表示内容: すべてのフィールド + 作成日時 + 更新日時

**FR-004: タスク編集**
- コマンド: `devtask edit <id> [options]`
- オプション: タスク作成と同様
- インタラクティブモード対応

**FR-005: タスク削除**
- コマンド: `devtask delete <id>`
- 確認プロンプト表示
- `-f, --force` で確認スキップ

**FR-006: ステータス変更**
- コマンド: `devtask status <id> <status>`
- エイリアス:
  - `devtask start <id>` → status in-progress
  - `devtask done <id>` → status done

**FR-007: 優先度変更**
- コマンド: `devtask priority <id> <priority>`

**FR-008: 優先度自動推定**
- コマンド: `devtask list --auto-priority`
- 推定アルゴリズム:
  - 期限までの残り日数でスコアリング（期限が近いほど高スコア）
  - 作成からの経過日数でスコアリング（古いほど高スコア）
  - ステータスが `in-progress` の場合は高スコア
  - 総合スコアで high / medium / low を判定
- 推定結果の表示:
  - `[Auto: high]` のように推定優先度を表示
  - 手動設定済みの場合は `[Manual: high]` と表示
- オプション: `--apply-auto` で推定結果を適用

### プロジェクト管理

**FR-009: プロジェクト初期化**
- コマンド: `devtask init [project-name]`
- `.devtask/` ディレクトリ作成
- `config.json` と `tasks.json` 生成
- `.gitignore` に追加（オプション）

**FR-010: 統計情報表示**
- コマンド: `devtask stats`
- 表示内容:
  - 総タスク数
  - ステータス別内訳
  - 優先度別内訳
  - 完了率

### データ管理

**FR-011: データ永続化**
- ファイル: `.devtask/tasks.json`
- 形式: JSON
- 自動保存

**FR-012: データエクスポート/インポート（将来的）**
- `devtask export <file>`
- `devtask import <file>`

## 非機能要件

### パフォーマンス
- **NFR-001**: CLI起動時間: 100ms以内
- **NFR-002**: コマンド実行時間: 50ms以内
- **NFR-003**: 1000件のタスクでも快適に動作

### ユーザビリティ
- **NFR-004**: 直感的なコマンド名
- **NFR-005**: ヘルプメッセージの充実
- **NFR-006**: エラーメッセージの明確化
- **NFR-007**: カラー出力対応
- **NFR-008**: プログレスバー・スピナー表示

### 互換性
- **NFR-009**: Node.js 18.x以上対応
- **NFR-010**: macOS, Linux, Windows対応
- **NFR-011**: 主要なターミナル（iTerm2, Terminal, PowerShell等）対応

### 保守性
- **NFR-012**: TypeScriptによる型安全性
- **NFR-013**: モジュラー設計
- **NFR-014**: テストカバレッジ80%以上

### セキュリティ
- **NFR-015**: ファイルパーミッション適切に設定
- **NFR-016**: 入力バリデーション
- **NFR-017**: コマンドインジェクション対策

## コマンド仕様

### 基本コマンド

```bash
# タスク作成
devtask add "バグ修正" -p high -d "ログイン機能のバグを修正"

# タスク一覧
devtask list
devtask list --status=todo
devtask list --priority=high
devtask list --search="バグ"
devtask list --auto-priority  # 優先度自動推定表示
devtask list --auto-priority --apply-auto  # 推定結果を適用

# タスク詳細
devtask show 1

# タスク編集
devtask edit 1 -p medium
devtask edit 1  # インタラクティブモード

# タスク削除
devtask delete 1
devtask delete 1 --force

# ステータス変更
devtask status 1 in-progress
devtask start 1  # エイリアス
devtask done 1   # エイリアス

# 優先度変更
devtask priority 1 high

# 統計情報
devtask stats

# プロジェクト初期化
devtask init
devtask init "My Project"

# ヘルプ
devtask --help
devtask add --help

# バージョン
devtask --version
```

## UI/UX要件

### カラースキーマ
- **優先度**
  - High: 赤色
  - Medium: 黄色
  - Low: 緑色
- **ステータス**
  - Todo: グレー
  - In Progress: 青色
  - Done: 緑色

### テーブル表示
- ボーダー付きテーブル
- ヘッダー行のハイライト
- 行の交互色分け（オプション）

### インタラクティブモード
- プロンプトベースの入力
- 選択肢の提示
- デフォルト値の表示

## 受け入れ条件

### MVP完成の条件
- すべてのP0機能が実装されている
- 非機能要件を満たしている
- ヘルプドキュメントが完備
- README.mdが充実
- 基本的なテストが実装されている
- npmパッケージとして公開可能

## 優先順位

### P0（必須 - MVP）
- タスクの作成・編集・削除
- タスク一覧表示
- ステータス管理
- 優先度管理
- **優先度自動推定機能**（差別化ポイント）
- フィルタリング・検索
- プロジェクト初期化
- データ永続化

### P1（重要）
- 統計情報
- タスク詳細表示
- インタラクティブモード
- カラー出力
- 優先度自動推定の精度向上

### P2（あれば良い）
- Git連携
- 期限管理
- タグ機能
- データエクスポート/インポート

### P3（将来的に）
- チーム機能
- リモート同期
- プラグインシステム
- 複数プロジェクト管理

## 競合分析

### 既存ツール
- **Taskwarrior**: 高機能だが複雑
- **Todo.txt**: シンプルだが機能不足
- **gh**: GitHub特化、汎用性低い

### Devtaskの差別化
- **優先順位の自動推定**: 期限、経過時間、ステータス変更履歴から自動判定
- 開発者向けに特化: ターミナル中心の操作
- シンプルで直感的: 最小限のコマンドで操作完了
- Gitとの自然な統合: 開発フローに溶け込む設計
- 軽量・高速: 100ms以内の起動、50ms以内のレスポンス
- モダンなCLI UX: カラー出力、テーブル表示、インタラクティブモード
